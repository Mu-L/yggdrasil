
# 文件: safe_wrap.hpp 文档

# 文件简介

safe_wrap.hpp 是 yggdrasil 项目中安全容器模块的一个头文件，主要实现了线程安全的对象包装器（safe_wrap）。该文件为任意对象提供线程安全的封装，适用于需要在多线程环境下安全读写、操作的场景。

# 主要功能

- 提供线程安全的对象包装器 `safe_wrap`，可对任意类型对象进行安全封装。
- 支持对象的安全读写、赋值、交换、克隆等操作。
- 支持自定义锁类型（如 boost::mutex、std::mutex 等）。
- 通过 mutex（互斥锁）实现线程安全，支持读写锁粒度控制。
- 支持智能指针管理，防止资源泄漏。

# 主要类型与成员

- `safe_wrap<T, Mutex>`：主模板类，T 为被包装对象类型，Mutex 为互斥类型。
- `value_type`：被包装对象类型。
- `mutex_type`、`read_lock_type`、`write_lock_type`：线程安全相关类型。
- 支持 `get`、`set`、`swap`、`clone`、`operator=` 等常用操作，均为线程安全实现。
- 支持通过回调安全访问和修改内部对象。

# 线程安全说明

- 所有成员函数均通过互斥锁保护，保证多线程环境下的安全性。
- 容器的创建和销毁本身不保证线程安全，建议在不同线程中创建/销毁时使用 swap 进行隔离。
- 禁止通过回调函数将内部对象的指针、引用等泄漏到外部并保存或使用。

# 典型用法

```cpp
yggr::safe_container::safe_wrap<int> sw(0);
sw.set(42);
int val = sw.get();
sw.swap(other_wrap);
```

# 注意事项

- 必须根据实际业务场景合理选择被包装对象类型和互斥类型。
- 不建议在多线程中直接创建/销毁 safe_wrap 实例，推荐使用 swap 进行线程间对象转移。
- 禁止将内部对象的指针、引用等通过回调泄漏到外部。

# 版权声明

版权所有 (c) 2010-2024 yggdrasil。遵循 MIT 许可证。



如需详细 API 说明，请参考具体成员函数实现和相关宏定义。